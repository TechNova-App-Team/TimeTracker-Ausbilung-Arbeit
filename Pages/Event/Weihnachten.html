<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frohe Weihnachten!</title>
    <link rel="stylesheet" href="../../Assets/css/snowflakes.css">
    <script src="../../Assets/js/icons.js"></script>
    <script src="../../Assets/js/touch-mobile-optimizations.js"></script>
    <script src="../../Assets/js/pinch-zoom.js"></script>
    <script src="../../Assets/js/snowflakes.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
            border-radius: 50%;
            animation: float linear infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            position: relative;
            z-index: 1001;
        }

        header {
            text-align: center;
            padding: 40px 0;
            margin-bottom: 40px;
            position: relative;
        }

        h1 {
            font-size: 5em;
            font-weight: 900;
            background: linear-gradient(45deg, #ffffff, #d0d0d0, #ffffff);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 3s ease infinite;
            filter: drop-shadow(0 0 30px rgba(255,255,255,0.5));
            letter-spacing: 5px;
            margin-bottom: 15px;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .subtitle {
            font-size: 1.4em;
            color: #c0c0c0;
            font-style: italic;
            text-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        .main-grid {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 30px;
            margin-bottom: 30px;
        }

        .panel {
            background: linear-gradient(145deg, rgba(40,40,40,0.9), rgba(20,20,20,0.9));
            border-radius: 25px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.8), 
                        inset 0 1px 0 rgba(255,255,255,0.1),
                        0 0 30px rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .panel h2 {
            font-size: 1.8em;
            margin-bottom: 25px;
            text-align: center;
            color: #ffffff;
            text-shadow: 0 0 20px rgba(255,255,255,0.3);
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255,255,255,0.2);
        }

        .canvas-container {
            background: linear-gradient(145deg, rgba(30,30,30,0.95), rgba(10,10,10,0.95));
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.9),
                        inset 0 0 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.15);
        }

        canvas {
            display: block;
            width: 100%;
            height: auto;
            max-width: 100%;
            border-radius: 20px;
            background: radial-gradient(circle at center, #0d0d0d 0%, #000000 100%);
            box-shadow: inset 0 0 80px rgba(0,0,0,0.9),
                        0 10px 40px rgba(0,0,0,0.8);
            border: 3px solid rgba(255,255,255,0.1);
        }

        .parts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .part-btn {
            padding: 15px;
            background: linear-gradient(145deg, rgba(60,60,60,0.8), rgba(40,40,40,0.8));
            border: 2px solid rgba(255,255,255,0.15);
            border-radius: 15px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1em;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .part-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .part-btn:hover::before {
            width: 400px;
            height: 400px;
        }

        .part-btn:hover {
            background: linear-gradient(145deg, rgba(80,80,80,0.9), rgba(60,60,60,0.9));
            border-color: rgba(255,255,255,0.3);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0,0,0,0.6),
                        0 0 20px rgba(255,255,255,0.1);
        }

        .part-btn:active {
            transform: translateY(-1px) scale(1);
        }

        .part-btn.added {
            background: linear-gradient(145deg, rgba(100,100,100,0.9), rgba(80,80,80,0.9));
            border-color: rgba(255,255,255,0.4);
            box-shadow: 0 0 30px rgba(255,255,255,0.2);
        }

        .action-btn {
            width: 100%;
            padding: 18px;
            margin-bottom: 15px;
            background: linear-gradient(145deg, rgba(70,70,70,0.9), rgba(50,50,50,0.9));
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.1em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
        }

        .action-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .action-btn:hover::after {
            left: 100%;
        }

        .action-btn:hover {
            background: linear-gradient(145deg, rgba(90,90,90,0.9), rgba(70,70,70,0.9));
            border-color: rgba(255,255,255,0.4);
            transform: translateY(-3px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.7),
                        0 0 30px rgba(255,255,255,0.15);
        }

        .clear-btn {
            background: linear-gradient(145deg, rgba(80,40,40,0.9), rgba(60,30,30,0.9));
            border-color: rgba(255,100,100,0.3);
        }

        .clear-btn:hover {
            background: linear-gradient(145deg, rgba(100,50,50,0.9), rgba(80,40,40,0.9));
            border-color: rgba(255,100,100,0.5);
            box-shadow: 0 10px 40px rgba(255,0,0,0.3);
        }

        .section-title {
            color: #c0c0c0;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 25px 0 15px 0;
            padding-left: 10px;
            border-left: 3px solid rgba(255,255,255,0.3);
        }

        .info-box {
            background: linear-gradient(145deg, rgba(30,30,30,0.8), rgba(15,15,15,0.8));
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            line-height: 1.8;
        }

        .info-box p {
            color: #b0b0b0;
            font-size: 0.95em;
            margin: 5px 0;
        }

        .emoji-large {
            font-size: 2em;
            display: inline-block;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shockwave {
            0% { 
                width: 40px; 
                height: 40px; 
                margin-left: -20px; 
                margin-top: -20px; 
                opacity: 1; 
            }
            100% { 
                width: 400px; 
                height: 400px; 
                margin-left: -200px; 
                margin-top: -200px; 
                opacity: 0; 
            }
        }

        @keyframes splatter {
            0% { 
                transform: scale(0);
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
            100% { 
                transform: scale(2.5);
                opacity: 0;
            }
        }

        @media (max-width: 1400px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 3em;
            }
        }

        @media (max-width: 900px) {
            * {
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                user-select: none;
            }

            body {
                padding: 10px;
                overflow-x: hidden;
            }

            header {
                padding: 20px 0;
                margin-bottom: 20px;
            }

            h1 {
                font-size: 2.2em;
                letter-spacing: 2px;
                margin-bottom: 8px;
                filter: drop-shadow(0 0 15px rgba(255,255,255,0.4));
            }

            .subtitle {
                font-size: 1em;
                text-shadow: 0 0 10px rgba(255,255,255,0.2);
            }

            .main-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                margin-bottom: 15px;
            }

            .panel {
                padding: 15px;
                border-radius: 15px;
                box-shadow: 0 8px 25px rgba(0,0,0,0.8);
            }

            .panel h2 {
                font-size: 1.3em;
                margin-bottom: 15px;
                padding-bottom: 10px;
                text-shadow: 0 0 10px rgba(255,255,255,0.2);
            }

            .parts-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
                margin-bottom: 12px;
            }

            .part-btn {
                padding: 12px 8px;
                font-size: 0.85em;
                letter-spacing: 0.5px;
                min-height: 50px;
                border-radius: 10px;
                font-weight: 500;
            }

            .action-btn {
                padding: 14px 12px;
                margin-bottom: 10px;
                font-size: 0.9em;
                letter-spacing: 1px;
                min-height: 48px;
                border-radius: 10px;
                font-weight: 600;
            }

            .section-title {
                font-size: 0.8em;
                margin: 15px 0 10px 0;
                letter-spacing: 1px;
            }

            .info-box {
                padding: 15px;
                margin-top: 15px;
                border-radius: 12px;
            }

            .info-box p {
                font-size: 0.85em;
                line-height: 1.6;
            }

            .emoji-large {
                font-size: 1.5em;
            }

            .canvas-container {
                padding: 10px;
                border-radius: 12px;
                margin-bottom: 10px;
            }

            canvas {
                border-radius: 12px;
                border: 2px solid rgba(255,255,255,0.1);
                max-height: 70vh;
                width: 100%;
                height: auto;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            header {
                padding: 15px 0;
                margin-bottom: 15px;
            }
            h1 {
                font-size: clamp(1.2em, 5vw, 2.2em);
                letter-spacing: 1px;
                margin-bottom: 5px;
            }
        }

        @media (max-width: 600px) {
            h1 {
                font-size: clamp(1em, 4vw, 1.6em);
                letter-spacing: 0.5px;
                margin-bottom: 3px;
            }

            .subtitle {
                font-size: clamp(0.75em, 3vw, 0.85em);
            }

            .container {
                padding: 0 5px;
            }

            .panel {
                padding: 12px;
                border-radius: 12px;
            }

            .panel h2 {
                font-size: 1.1em;
                margin-bottom: 12px;
                padding-bottom: 8px;
            }

            .parts-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 6px;
            }

            .part-btn {
                padding: 10px 6px;
                font-size: 0.75em;
                min-height: 44px;
                border-radius: 8px;
            }

            .part-btn span {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 3px;
            }

            .action-btn {
                padding: 12px 10px;
                margin-bottom: 8px;
                font-size: 0.8em;
                letter-spacing: 0.5px;
                min-height: 44px;
            }

            .section-title {
                font-size: 0.75em;
                margin: 12px 0 8px 0;
            }

            .canvas-container {
                padding: 10px;
                border-radius: 10px;
                margin-bottom: 12px;
            }

            canvas {
                min-height: 300px;
                max-height: 65vh;
            }

            .info-box {
                padding: 12px;
                margin-top: 10px;
                border-radius: 10px;
            }

            .info-box p {
                font-size: 0.8em;
                margin: 3px 0;
            }
        }

        @media (max-height: 700px) and (orientation: landscape) {
            body {
                padding: 5px;
            }

            header {
                padding: 10px 0;
                margin-bottom: 10px;
            }

            h1 {
                font-size: 1.5em;
                margin-bottom: 3px;
            }

            .subtitle {
                display: none;
            }

            .canvas-container {
                padding: 8px;
                margin-bottom: 8px;
                max-height: 80vh;
            }

            canvas {
                max-height: 70vh;
            }

            .main-grid {
                gap: 10px;
            }

            .panel {
                padding: 10px;
            }

            .info-box {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <div class="container">
        <header>
            <h1>üéÖ WEIHNACHTSMANN BUILDER üéÖ</h1>
            <p class="subtitle">Erschaffe den perfekten Weihnachtsmann - Teil f√ºr Teil</p>
        </header>

        <div class="main-grid">
            <div class="panel">
                <h2>üë§ K√∂rper & Kopf</h2>
                <div class="parts-grid">
                    <button class="part-btn" onclick="addPart('body')">
                        <span>‚ö´ K√∂rper</span>
                    </button>
                    <button class="part-btn" onclick="addPart('head')">
                        <span>‚ö™ Kopf</span>
                    </button>
                    <button class="part-btn" onclick="addPart('arms')">
                        <span>üí™ Arme</span>
                    </button>
                    <button class="part-btn" onclick="addPart('legs')">
                        <span>ü¶µ Beine</span>
                    </button>
                </div>

                <div class="section-title">üé© Kleidung</div>
                <div class="parts-grid">
                    <button class="part-btn" onclick="addPart('hat')">
                        <span>üé© M√ºtze</span>
                    </button>
                    <button class="part-btn" onclick="addPart('belt')">
                        <span>‚¨õ G√ºrtel</span>
                    </button>
                    <button class="part-btn" onclick="addPart('boots')">
                        <span>üë¢ Stiefel</span>
                    </button>
                    <button class="part-btn" onclick="addPart('gloves')">
                        <span>üß§ Handschuhe</span>
                    </button>
                </div>

                <div class="section-title">üòä Gesicht</div>
                <div class="parts-grid">
                    <button class="part-btn" onclick="addPart('eyes')">
                        <span>üëÅÔ∏è Augen</span>
                    </button>
                    <button class="part-btn" onclick="addPart('nose')">
                        <span>ü•ï Nase</span>
                    </button>
                    <button class="part-btn" onclick="addPart('mouth')">
                        <span>üòä Mund</span>
                    </button>
                    <button class="part-btn" onclick="addPart('beard')">
                        <span>üßî Bart</span>
                    </button>
                </div>
            </div>

            <div class="canvas-container">
                <canvas id="santaCanvas" width="800" height="900"></canvas>
                <div class="info-box">
                    <p><span class="emoji-large">‚ú®</span></p>
                    <p><strong>Klicke auf die Buttons</strong> um deinen Weihnachtsmann zu bauen!</p>
                    <p>Jedes Teil wird automatisch perfekt positioniert</p>
                </div>
            </div>

            <div class="panel">
                <h2>‚ú® Extras & Deko</h2>
                <div class="parts-grid">
                    <button class="part-btn" onclick="addPart('buttons')">
                        <span>üîò Kn√∂pfe</span>
                    </button>
                    <button class="part-btn" onclick="addPart('buckle')">
                        <span>üì¶ Schnalle</span>
                    </button>
                    <button class="part-btn" onclick="addPart('pockets')">
                        <span>üëú Taschen</span>
                    </button>
                    <button class="part-btn" onclick="addPart('pompom')">
                        <span>‚ö™ Bommel</span>
                    </button>
                    <button class="part-btn" onclick="addPart('collar')">
                        <span>‚¨ú Kragen</span>
                    </button>
                    <button class="part-btn" onclick="addPart('eyebrows')">
                        <span>„Ä∞Ô∏è Augenbrauen</span>
                    </button>
                </div>

                <div class="section-title">üéÆ Aktionen</div>
                <button class="action-btn" onclick="addAllParts()">
                    üéØ ALLES HINZUF√úGEN
                </button>
                <button class="action-btn clear-btn" onclick="clearAll()">
                    üóëÔ∏è NEU STARTEN
                </button>
                <button class="action-btn" onclick="randomize()">
                    üé≤ ZUF√ÑLLIG
                </button>
                <button class="action-btn" onclick="downloadCanvas()">
                    üíæ SPEICHERN
                </button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('santaCanvas');
        const ctx = canvas.getContext('2d');
        const parts = new Set();

        // Canvas f√ºr mobile anpassen
        function adjustCanvasSize() {
            const container = canvas.parentElement;
            const isMobile = window.innerWidth < 900;
            
            if (isMobile) {
                const width = Math.min(window.innerWidth - 30, 600);
                canvas.width = width;
                canvas.height = Math.floor(width * 1.125); // 800x900 Verh√§ltnis
            } else {
                canvas.width = 800;
                canvas.height = 900;
            }
        }

        adjustCanvasSize();
        window.addEventListener('resize', adjustCanvasSize);

        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.width = (Math.random() * 4 + 2) + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particle.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(particle);
            }
        }
        createParticles();

        function drawBackground() {
            const gradient = ctx.createRadialGradient(400, 450, 100, 400, 450, 600);
            gradient.addColorStop(0, '#0d0d0d');
            gradient.addColorStop(1, '#000000');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 800, 900);
        }

        function addPart(part) {
            parts.add(part);
            event.target.closest('.part-btn').classList.add('added');
            drawSanta();
        }

        function clearAll() {
            parts.clear();
            document.querySelectorAll('.part-btn').forEach(btn => {
                btn.classList.remove('added');
            });
            drawBackground();
        }

        function addAllParts() {
            const allParts = ['body', 'head', 'arms', 'legs', 'hat', 'belt', 'boots', 
                            'gloves', 'eyes', 'nose', 'mouth', 'beard', 'buttons', 
                            'buckle', 'pockets', 'pompom', 'collar', 'eyebrows'];
            allParts.forEach(p => parts.add(p));
            document.querySelectorAll('.part-btn').forEach(btn => {
                btn.classList.add('added');
            });
            drawSanta();
        }

        function randomize() {
            clearAll();
            const allParts = ['body', 'head', 'arms', 'legs', 'hat', 'belt', 'boots', 
                            'gloves', 'eyes', 'nose', 'mouth', 'beard', 'buttons', 
                            'buckle', 'pockets', 'pompom', 'collar', 'eyebrows'];
            allParts.forEach(p => {
                if (Math.random() > 0.3) {
                    parts.add(p);
                    document.querySelector(`[onclick="addPart('${p}')"]`)?.classList.add('added');
                }
            });
            drawSanta();
        }

        function downloadCanvas() {
            const link = document.createElement('a');
            link.download = 'mein-weihnachtsmann.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        function drawSanta() {
            drawBackground();
            
            if (parts.has('legs')) {
                ctx.fillStyle = '#e8e8e8';
                ctx.fillRect(320, 620, 70, 150);
                ctx.fillRect(410, 620, 70, 150);
                ctx.fillStyle = 'rgba(0,0,0,0.3)';
                ctx.fillRect(330, 620, 15, 150);
                ctx.fillRect(420, 620, 15, 150);
            }
            
            if (parts.has('boots')) {
                ctx.fillStyle = '#2d2d2d';
                ctx.fillRect(310, 750, 90, 60);
                ctx.fillRect(400, 750, 90, 60);
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(315, 755, 20, 50);
                ctx.fillRect(405, 755, 20, 50);
            }
            
            if (parts.has('body')) {
                const gradient = ctx.createLinearGradient(300, 400, 500, 600);
                gradient.addColorStop(0, '#f0f0f0');
                gradient.addColorStop(0.5, '#e0e0e0');
                gradient.addColorStop(1, '#d0d0d0');
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.ellipse(400, 520, 140, 160, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'rgba(0,0,0,0.15)';
                ctx.beginPath();
                ctx.ellipse(420, 540, 120, 140, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            
            if (parts.has('belt')) {
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(260, 560, 280, 35);
                ctx.fillStyle = '#0a0a0a';
                ctx.fillRect(265, 565, 270, 10);
            }
            
            if (parts.has('buckle')) {
                ctx.fillStyle = '#808080';
                ctx.fillRect(370, 555, 60, 45);
                ctx.fillStyle = '#606060';
                ctx.fillRect(380, 565, 40, 25);
                ctx.strokeStyle = '#a0a0a0';
                ctx.lineWidth = 3;
                ctx.strokeRect(370, 555, 60, 45);
            }
            
            if (parts.has('pockets')) {
                ctx.fillStyle = '#c0c0c0';
                ctx.fillRect(280, 480, 50, 40);
                ctx.fillRect(470, 480, 50, 40);
                ctx.strokeStyle = '#909090';
                ctx.lineWidth = 2;
                ctx.strokeRect(280, 480, 50, 40);
                ctx.strokeRect(470, 480, 50, 40);
            }
            
            if (parts.has('arms')) {
                ctx.fillStyle = '#e8e8e8';
                ctx.beginPath();
                ctx.ellipse(280, 480, 35, 90, -0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(520, 480, 35, 90, 0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'rgba(0,0,0,0.2)';
                ctx.beginPath();
                ctx.ellipse(290, 490, 25, 80, -0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(510, 490, 25, 80, 0.3, 0, Math.PI * 2);
                ctx.fill();
            }
            
            if (parts.has('gloves')) {
                ctx.fillStyle = '#e0e0e0';
                ctx.beginPath();
                ctx.arc(275, 560, 30, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(525, 560, 30, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#c0c0c0';
                ctx.beginPath();
                ctx.arc(280, 565, 22, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(520, 565, 22, 0, Math.PI * 2);
                ctx.fill();
            }
            
            if (parts.has('collar')) {
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(340, 355, 120, 25);
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(345, 360, 110, 15);
            }
            
            if (parts.has('head')) {
                const headGradient = ctx.createRadialGradient(390, 290, 20, 400, 300, 100);
                headGradient.addColorStop(0, '#ffffff');
                headGradient.addColorStop(0.7, '#f0f0f0');
                headGradient.addColorStop(1, '#e0e0e0');
                ctx.fillStyle = headGradient;
                ctx.beginPath();
                ctx.arc(400, 300, 90, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'rgba(0,0,0,0.1)';
                ctx.beginPath();
                ctx.ellipse(400, 380, 80, 15, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            
            if (parts.has('beard')) {
                ctx.fillStyle = '#f8f8f8';
                ctx.beginPath();
                ctx.arc(400, 350, 70, 0, Math.PI, false);
                ctx.lineTo(380, 380);
                ctx.quadraticCurveTo(400, 400, 420, 380);
                ctx.closePath();
                ctx.fill();
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 2;
                for(let i = 0; i < 5; i++) {
                    ctx.beginPath();
                    ctx.moveTo(360 + i * 20, 360);
                    ctx.lineTo(365 + i * 20, 385);
                    ctx.stroke();
                }
            }
            
            if (parts.has('eyebrows')) {
                ctx.fillStyle = '#d0d0d0';
                ctx.fillRect(355, 275, 35, 8);
                ctx.fillRect(410, 275, 35, 8);
            }
            
            if (parts.has('eyes')) {
                ctx.fillStyle = '#1a1a1a';
                ctx.beginPath();
                ctx.arc(370, 295, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(430, 295, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#808080';
                ctx.beginPath();
                ctx.arc(372, 293, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(432, 293, 3, 0, Math.PI * 2);
                ctx.fill();
            }
            
            if (parts.has('nose')) {
                const noseGradient = ctx.createLinearGradient(400, 320, 455, 325);
                noseGradient.addColorStop(0, '#b0b0b0');
                noseGradient.addColorStop(0.5, '#909090');
                noseGradient.addColorStop(1, '#707070');
                ctx.fillStyle = noseGradient;
                ctx.beginPath();
                ctx.moveTo(400, 315);
                ctx.lineTo(455, 325);
                ctx.lineTo(400, 335);
                ctx.closePath();
                ctx.fill();
                ctx.strokeStyle = '#606060';
                ctx.lineWidth = 1.5;
                ctx.beginPath();
                ctx.moveTo(420, 320);
                ctx.lineTo(418, 330);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(435, 323);
                ctx.lineTo(433, 327);
                ctx.stroke();
            }
            
            if (parts.has('mouth')) {
                ctx.strokeStyle = '#2d2d2d';
                ctx.lineWidth = 4;
                ctx.lineCap = 'round';
                ctx.beginPath();
                ctx.arc(400, 345, 25, 0.2, Math.PI - 0.2);
                ctx.stroke();
                ctx.lineWidth = 2;
                ctx.strokeStyle = '#404040';
                ctx.beginPath();
                ctx.moveTo(380, 350);
                ctx.lineTo(385, 355);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(420, 350);
                ctx.lineTo(415, 355);
                ctx.stroke();
            }
            
            if (parts.has('hat')) {
                const hatGradient = ctx.createLinearGradient(300, 180, 500, 240);
                hatGradient.addColorStop(0, '#404040');
                hatGradient.addColorStop(0.5, '#2d2d2d');
                hatGradient.addColorStop(1, '#1a1a1a');
                ctx.fillStyle = hatGradient;
                ctx.beginPath();
                ctx.moveTo(310, 235);
                ctx.lineTo(400, 150);
                ctx.lineTo(490, 235);
                ctx.closePath();
                ctx.fill();
                ctx.fillStyle = '#e8e8e8';
                ctx.fillRect(305, 225, 190, 18);
                ctx.fillStyle = '#d0d0d0';
                ctx.fillRect(310, 230, 180, 8);
            }
            
            if (parts.has('pompom')) {
                const pomGradient = ctx.createRadialGradient(395, 145, 5, 400, 150, 25);
                pomGradient.addColorStop(0, '#ffffff');
                pomGradient.addColorStop(1, '#d0d0d0');
                ctx.fillStyle = pomGradient;
                ctx.beginPath();
                ctx.arc(400, 150, 25, 0, Math.PI * 2);
                ctx.fill();
                for(let i = 0; i < 8; i++) {
                    const angle = (Math.PI * 2 / 8) * i;
                    const x = 400 + Math.cos(angle) * 20;
                    const y = 150 + Math.sin(angle) * 20;
                    ctx.fillStyle = 'rgba(255,255,255,0.5)';
                    ctx.beginPath();
                    ctx.arc(x, y, 8, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            if (parts.has('buttons')) {
                const buttonPositions = [450, 500, 550];
                buttonPositions.forEach(y => {
                    ctx.fillStyle = '#2d2d2d';
                    ctx.beginPath();
                    ctx.arc(400, y, 12, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.strokeStyle = '#505050';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    ctx.fillStyle = '#1a1a1a';
                    ctx.beginPath();
                    ctx.arc(396, y, 2, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.beginPath();
                    ctx.arc(404, y, 2, 0, Math.PI * 2);
                    ctx.fill();
                });
            }
        }

        drawBackground();

        // ===============================================
        // üí• ULTRA SCHNEEBALL SYSTEM MIT AUFKLATSCH! üí•
        // ===============================================

        const snowballUI = document.createElement('div');
        const isMobile = window.innerWidth < 900;
        snowballUI.innerHTML = `
            <div style="position: fixed; ${isMobile ? 'bottom: 10px; right: 10px; padding: 12px 18px;' : 'top: 30px; right: 30px; padding: 25px 35px;'} z-index: 1000; background: linear-gradient(135deg, rgba(10,10,30,0.95) 0%, rgba(20,20,50,0.95) 100%); border-radius: ${isMobile ? '12px' : '20px'}; border: 2px solid #00d4ff; font-family: 'Segoe UI', sans-serif; color: #00d4ff; text-align: center; box-shadow: 0 0 60px rgba(0,212,255,0.6), inset 0 1px 0 rgba(255,255,255,0.1), 0 20px 40px rgba(0,0,0,0.8); backdrop-filter: blur(10px); max-width: ${isMobile ? '120px' : '250px'};">
                <div style="font-size: ${isMobile ? '11px' : '16px'}; opacity: 0.8; margin-bottom: ${isMobile ? '6px' : '12px'}; letter-spacing: 1px; text-transform: uppercase; font-weight: 600;">B√§lle</div>
                <div style="font-size: ${isMobile ? '32px' : '52px'}; margin-bottom: ${isMobile ? '6px' : '15px'}; text-shadow: 0 0 20px #00d4ff, 0 0 40px rgba(0,212,255,0.5); font-weight: 900; letter-spacing: 2px;"><span id="snowballCount" style="background: linear-gradient(45deg, #00d4ff, #00ffff, #00d4ff); background-size: 200% 200%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; animation: gradientShift 3s ease infinite;">0</span></div>
                <div style="font-size: ${isMobile ? '9px' : '13px'}; opacity: 0.85; margin-bottom: 4px; font-weight: 600; color: #00ffff;">‚¨áÔ∏è HALTEN ‚¨áÔ∏è</div>
                <div style="font-size: ${isMobile ? '8px' : '11px'}; opacity: 0.7; color: #a0d4ff; line-height: 1.3;">${isMobile ? 'Halten & werfen' : 'Maus/Touch halten<br>‚Üí Energie laden<br>‚Üí Loslassen = üí•'}</div>
            </div>
            <style>
                @keyframes gradientShift {
                    0%, 100% { background-position: 0% 50%; }
                    50% { background-position: 100% 50%; }
                }
            </style>
        `;
        document.body.appendChild(snowballUI);

        const snowballCanvas = document.createElement('canvas');
        const dpr = window.devicePixelRatio || 1;
        snowballCanvas.width = window.innerWidth * dpr;
        snowballCanvas.height = window.innerHeight * dpr;
        snowballCanvas.style.width = window.innerWidth + 'px';
        snowballCanvas.style.height = window.innerHeight + 'px';
        Object.assign(snowballCanvas.style, {
            position: 'fixed',
            top: '0',
            left: '0',
            zIndex: '998',
            pointerEvents: 'none'
        });
        document.body.appendChild(snowballCanvas);

        const snowCtx = snowballCanvas.getContext('2d');
        snowCtx.scale(dpr, dpr);
        let snowballs = [];
        let splatters = [];
        let snowballCount = 0;
        let isCharging = false;
        let chargeLevel = 0;
        let mousePos = { x: 0, y: 0 };

        document.addEventListener('mousemove', (e) => {
            mousePos.x = e.clientX;
            mousePos.y = e.clientY;
        }, { passive: true });

        document.addEventListener('mousedown', (e) => {
            if (e.button === 0) {
                isCharging = true;
                chargeLevel = 0;
            }
        }, { passive: true });

        document.addEventListener('mouseup', (e) => {
            if (isCharging && chargeLevel > 10) {
                throwSnowball();
            }
            isCharging = false;
            chargeLevel = 0;
        }, { passive: true });

        document.addEventListener('touchstart', (e) => {
            isCharging = true;
            chargeLevel = 0;
            const touch = e.touches[0];
            mousePos.x = touch.clientX;
            mousePos.y = touch.clientY;
        }, { passive: true });

        document.addEventListener('touchmove', (e) => {
            const touch = e.touches[0];
            mousePos.x = touch.clientX;
            mousePos.y = touch.clientY;
        }, { passive: true });

        document.addEventListener('touchend', () => {
            if (isCharging && chargeLevel > 10) {
                throwSnowball();
            }
            isCharging = false;
            chargeLevel = 0;
        }, { passive: true });

        function throwSnowball() {
            const power = Math.min(chargeLevel / 100, 1);
            const speed = 8 + power * 15;
            const angle = Math.random() * Math.PI * 2;

            const ball = {
                x: mousePos.x,
                y: mousePos.y,
                vx: Math.cos(angle) * speed,
                vy: Math.sin(angle) * speed - 5,
                radius: 12 + power * 10,
                life: 1,
                age: 0,
                maxAge: 150,
                rotation: Math.random() * Math.PI * 2,
                rotSpeed: (Math.random() - 0.5) * 0.4,
                trail: [],
                power: power
            };

            snowballs.push(ball);
            snowballCount++;
            document.getElementById('snowballCount').textContent = snowballCount;
        }

        function createSplatter(x, y, power) {
            const splatter = {
                x: x,
                y: y,
                radius: 30 + power * 50,
                life: 1,
                maxLife: 50,
                age: 0,
                splatMarks: []
            };

            for (let i = 0; i < 35; i++) {
                const angle = (Math.PI * 2 / 35) * i + (Math.random() - 0.5) * 0.8;
                const dist = 25 + Math.random() * (40 + power * 50);
                splatter.splatMarks.push({
                    angle: angle,
                    dist: dist,
                    size: 6 + Math.random() * (10 + power * 12),
                    offsetX: (Math.random() - 0.5) * 20,
                    offsetY: (Math.random() - 0.5) * 20,
                    decay: 0.92 + Math.random() * 0.06
                });
            }

            splatters.push(splatter);

            for (let i = 0; i < 60 + power * 50; i++) {
                const particle = document.createElement('div');
                const angle = Math.random() * Math.PI * 2;
                const speed = 4 + Math.random() * (10 + power * 8);
                const size = 4 + Math.random() * (6 + power * 5);

                Object.assign(particle.style, {
                    position: 'fixed',
                    left: x + 'px',
                    top: y + 'px',
                    width: size + 'px',
                    height: size + 'px',
                    backgroundColor: '#ffffff',
                    borderRadius: '50%',
                    zIndex: '999',
                    pointerEvents: 'none',
                    boxShadow: '0 0 12px rgba(255,255,255,0.9), 0 0 6px rgba(0,212,255,0.6)',
                    border: '1px solid rgba(200,220,255,0.7)',
                    filter: 'drop-shadow(0 0 4px rgba(0,212,255,0.4))'
                });

                document.body.appendChild(particle);

                let lifetime = 35 + Math.random() * 35;
                let px = x, py = y;
                let vx = Math.cos(angle) * speed;
                let vy = Math.sin(angle) * speed;

                const animate = setInterval(() => {
                    lifetime--;
                    vy += 0.35;
                    px += vx;
                    py += vy;
                    vx *= 0.97;

                    particle.style.left = px + 'px';
                    particle.style.top = py + 'px';
                    particle.style.opacity = lifetime / 70;

                    if (lifetime <= 0 || py > window.innerHeight) {
                        clearInterval(animate);
                        particle.remove();
                    }
                }, 16);
            }

            const shockwave = document.createElement('div');
            Object.assign(shockwave.style, {
                position: 'fixed',
                left: x + 'px',
                top: y + 'px',
                width: '40px',
                height: '40px',
                border: '3px solid rgba(0,212,255,0.9)',
                borderRadius: '50%',
                marginLeft: '-20px',
                marginTop: '-20px',
                zIndex: '999',
                pointerEvents: 'none',
                boxShadow: '0 0 30px rgba(0,212,255,0.8), inset 0 0 15px rgba(0,212,255,0.4)',
                animation: 'shockwave 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards'
            });
            document.body.appendChild(shockwave);
            setTimeout(() => shockwave.remove(), 700);

            const glow = document.createElement('div');
            Object.assign(glow.style, {
                position: 'fixed',
                left: x + 'px',
                top: y + 'px',
                width: '100px',
                height: '100px',
                background: 'radial-gradient(circle, rgba(0,212,255,0.6) 0%, rgba(0,212,255,0.2) 50%, transparent 100%)',
                borderRadius: '50%',
                marginLeft: '-50px',
                marginTop: '-50px',
                zIndex: '998',
                pointerEvents: 'none',
                animation: 'glowPulse 0.6s ease-out forwards'
            });
            document.body.appendChild(glow);
            setTimeout(() => glow.remove(), 600);
        }

        function drawSnowballs() {
            for (let i = snowballs.length - 1; i >= 0; i--) {
                const ball = snowballs[i];

                ball.vy += 0.5;
                ball.x += ball.vx;
                ball.y += ball.vy;
                ball.age++;
                ball.life = Math.max(0, 1 - (ball.age / ball.maxAge));
                ball.rotation += ball.rotSpeed;

                ball.trail.push({ x: ball.x, y: ball.y, life: ball.life });
                if (ball.trail.length > 12) ball.trail.shift();

                snowCtx.strokeStyle = `rgba(255, 255, 255, ${ball.life * 0.4})`;
                snowCtx.lineWidth = ball.radius * 0.6;
                snowCtx.lineCap = 'round';
                snowCtx.lineJoin = 'round';
                snowCtx.beginPath();
                for (let j = 0; j < ball.trail.length; j++) {
                    const t = ball.trail[j];
                    if (j === 0) snowCtx.moveTo(t.x, t.y);
                    else snowCtx.lineTo(t.x, t.y);
                }
                snowCtx.stroke();

                if (ball.power > 0.4) {
                    const glowGradient = snowCtx.createRadialGradient(ball.x, ball.y, 0, ball.x, ball.y, ball.radius * 3.5);
                    glowGradient.addColorStop(0, `rgba(200, 230, 255, ${ball.life * 0.5})`);
                    glowGradient.addColorStop(1, 'rgba(100, 200, 255, 0)');
                    snowCtx.fillStyle = glowGradient;
                    snowCtx.fillRect(ball.x - ball.radius * 3.5, ball.y - ball.radius * 3.5, ball.radius * 7, ball.radius * 7);
                }

                snowCtx.save();
                snowCtx.translate(ball.x, ball.y);
                snowCtx.rotate(ball.rotation);
                snowCtx.globalAlpha = ball.life;

                // Haupt-Schneeball mit Premium-Gradient
                const ballGradient = snowCtx.createRadialGradient(-5, -5, 2, 0, 0, ball.radius);
                ballGradient.addColorStop(0, '#ffffff');
                ballGradient.addColorStop(0.2, '#f8f8f8');
                ballGradient.addColorStop(0.5, '#e8e8e8');
                ballGradient.addColorStop(0.85, '#d0d0d0');
                ballGradient.addColorStop(1, '#909090');

                snowCtx.fillStyle = ballGradient;
                snowCtx.beginPath();
                snowCtx.arc(0, 0, ball.radius, 0, Math.PI * 2);
                snowCtx.fill();

                // Leuchtender Rand
                snowCtx.strokeStyle = `rgba(0, 212, 255, ${0.6 * ball.life})`;
                snowCtx.lineWidth = 3;
                snowCtx.stroke();

                // Innerer Glanz
                const innerGlow = snowCtx.createRadialGradient(-6, -6, 0, -6, -6, 12);
                innerGlow.addColorStop(0, `rgba(255, 255, 255, ${0.9 * ball.life})`);
                innerGlow.addColorStop(1, 'rgba(255, 255, 255, 0)');
                snowCtx.fillStyle = innerGlow;
                snowCtx.beginPath();
                snowCtx.arc(-6, -6, 12, 0, Math.PI * 2);
                snowCtx.fill();

                // Eiskristalle
                snowCtx.fillStyle = `rgba(200, 230, 255, ${0.6 * ball.life})`;
                const crystals = Math.ceil(ball.radius / 2);
                for (let j = 0; j < crystals; j++) {
                    const angle = (Math.PI * 2 / crystals) * j + ball.rotation;
                    const dist = ball.radius * 0.65;
                    const px = Math.cos(angle) * dist;
                    const py = Math.sin(angle) * dist;
                    snowCtx.beginPath();
                    snowCtx.arc(px, py, 5, 0, Math.PI * 2);
                    snowCtx.fill();
                }

                // Externe Glanz-Reflexion
                const glanzGradient = snowCtx.createRadialGradient(-8, -8, 0, -8, -8, 15);
                glanzGradient.addColorStop(0, `rgba(255, 255, 255, ${0.95 * ball.life})`);
                glanzGradient.addColorStop(0.4, `rgba(255, 255, 255, ${0.4 * ball.life})`);
                glanzGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
                snowCtx.fillStyle = glanzGradient;
                snowCtx.beginPath();
                snowCtx.arc(-8, -8, 15, 0, Math.PI * 2);
                snowCtx.fill();

                // Aura-Effekt
                snowCtx.strokeStyle = `rgba(0, 212, 255, ${0.3 * ball.life})`;
                snowCtx.lineWidth = 2;
                snowCtx.beginPath();
                snowCtx.arc(0, 0, ball.radius + 8, 0, Math.PI * 2);
                snowCtx.stroke();

                snowCtx.restore();

                if (ball.y > window.innerHeight - 50 || ball.age > ball.maxAge || 
                    ball.x < -50 || ball.x > window.innerWidth + 50) {
                    if (ball.y > window.innerHeight - 100) {
                        createSplatter(ball.x, Math.min(ball.y, window.innerHeight), ball.power);
                    }
                    snowballs.splice(i, 1);
                }
            }
        }

        function drawSplatters() {
            for (let i = splatters.length - 1; i >= 0; i--) {
                const splat = splatters[i];
                splat.age++;
                splat.life = Math.max(0, 1 - (splat.age / splat.maxLife));

                snowCtx.globalAlpha = splat.life * 0.8;

                for (let mark of splat.splatMarks) {
                    const x = splat.x + Math.cos(mark.angle) * mark.dist + mark.offsetX;
                    const y = splat.y + Math.sin(mark.angle) * mark.dist + mark.offsetY;

                    const markGradient = snowCtx.createRadialGradient(x, y, 0, x, y, mark.size);
                    markGradient.addColorStop(0, '#ffffff');
                    markGradient.addColorStop(0.5, '#f0f0f0');
                    markGradient.addColorStop(1, 'rgba(200, 200, 200, 0)');

                    snowCtx.fillStyle = markGradient;
                    snowCtx.beginPath();
                    snowCtx.arc(x, y, mark.size, 0, Math.PI * 2);
                    snowCtx.fill();

                    snowCtx.strokeStyle = 'rgba(150, 150, 150, 0.3)';
                    snowCtx.lineWidth = 1;
                    snowCtx.stroke();
                }

                snowCtx.globalAlpha = 1;

                if (splat.life <= 0) {
                    splatters.splice(i, 1);
                }
            }
        }

        function drawCharge() {
            if (!isCharging) return;

            chargeLevel = Math.min(chargeLevel + 3, 100);

            // Mehrschichtige Lade-Ringe mit Gradient
            const rings = 4;
            for (let i = 0; i < rings; i++) {
                const radius = 30 + chargeLevel * 0.8 + i * 20;
                const opacity = Math.max(0.1, (0.5 - i * 0.1) * (chargeLevel / 100));
                
                snowCtx.strokeStyle = `rgba(0, 212, 255, ${opacity})`;
                snowCtx.lineWidth = 4 - i * 0.8;
                snowCtx.beginPath();
                snowCtx.arc(mousePos.x, mousePos.y, radius, 0, (Math.PI * 2 * chargeLevel) / 100);
                snowCtx.stroke();
            }

            // √Ñu√üerer leuchtender Ring
            snowCtx.strokeStyle = `rgba(0, 255, 200, ${chargeLevel / 200})`;
            snowCtx.lineWidth = 2;
            snowCtx.setLineDash([5, 5]);
            snowCtx.beginPath();
            snowCtx.arc(mousePos.x, mousePos.y, 25 + chargeLevel * 0.6, 0, Math.PI * 2);
            snowCtx.stroke();
            snowCtx.setLineDash([]);

            // Prozenttext mit besserem Stil
            snowCtx.fillStyle = `rgba(0, 212, 255, ${0.9 + chargeLevel / 300})`;
            snowCtx.font = 'bold 32px "Segoe UI", sans-serif';
            snowCtx.textAlign = 'center';
            snowCtx.strokeStyle = 'rgba(0, 0, 0, 0.9)';
            snowCtx.lineWidth = 4;
            snowCtx.strokeText(`${Math.floor(chargeLevel)}%`, mousePos.x, mousePos.y - 50 - chargeLevel * 0.3);
            snowCtx.fillText(`${Math.floor(chargeLevel)}%`, mousePos.x, mousePos.y - 50 - chargeLevel * 0.3);

            // Zusatztext
            snowCtx.fillStyle = `rgba(0, 255, 200, ${0.7})`;
            snowCtx.font = '14px "Segoe UI", sans-serif';
            snowCtx.fillText('‚ö° LADEENERGIE', mousePos.x, mousePos.y + 40 + chargeLevel * 0.2);

            // Energie-Partikel
            if (chargeLevel % 4 === 0) {
                for (let i = 0; i < 4; i++) {
                    const particle = document.createElement('div');
                    const angle = (Math.PI * 2 / 4) * i + Math.random() * 0.3;
                    const speed = 3 + Math.random() * 2;

                    Object.assign(particle.style, {
                        position: 'fixed',
                        left: mousePos.x + 'px',
                        top: mousePos.y + 'px',
                        width: '5px',
                        height: '5px',
                        backgroundColor: '#00ffff',
                        borderRadius: '50%',
                        zIndex: '999',
                        pointerEvents: 'none',
                        boxShadow: '0 0 12px #00d4ff, 0 0 6px #00ffff'
                    });

                    document.body.appendChild(particle);

                    let lifetime = 25;
                    let px = mousePos.x;
                    let py = mousePos.y;
                    const vx = Math.cos(angle) * speed;
                    const vy = Math.sin(angle) * speed;

                    const animate = setInterval(() => {
                        lifetime--;
                        px += vx;
                        py += vy * 0.8;

                        particle.style.left = px + 'px';
                        particle.style.top = py + 'px';
                        particle.style.opacity = lifetime / 25;

                        if (lifetime <= 0) {
                            clearInterval(animate);
                            particle.remove();
                        }
                    }, 16);
                }
            }
        }

        function animate() {
            snowCtx.clearRect(0, 0, snowballCanvas.width, snowballCanvas.height);
            drawSplatters();
            drawSnowballs();
            drawCharge();
            requestAnimationFrame(animate);
        }
        animate();

        function resizeSnowballCanvas() {
            const dpr = window.devicePixelRatio || 1;
            snowballCanvas.width = window.innerWidth * dpr;
            snowballCanvas.height = window.innerHeight * dpr;
            snowballCanvas.style.width = window.innerWidth + 'px';
            snowballCanvas.style.height = window.innerHeight + 'px';
            snowCtx.scale(dpr, dpr);
        }
        
        resizeSnowballCanvas();
        window.addEventListener('resize', resizeSnowballCanvas);
    </script>

</body>
</html>